---
title: "JavaScript SDK"
description: "Add Agnitra optimization and usage reporting to Node.js, edge, and browser runtimes."
---

# JavaScript SDK

Use the JavaScript/TypeScript SDK to orchestrate optimizations from Node.js services, serverless functions, or modern frontend frameworks. The client mirrors the Python API and returns optimized artifacts, telemetry summaries, and usage events you can forward to analytics or billing.

## Installation

```bash
npm install agnitra
# or
yarn add agnitra
pnpm add agnitra
```

Set the API key and base URL using environment variables or your deployment platformâ€™s secret manager:

```bash
export AGNITRA_API_KEY="sk-live-..."
export AGNITRA_API_BASE_URL="https://api.agnitra.ai"
```

## Create a client

```ts
import { AgnitraClient } from "agnitra";

export const agnitra = new AgnitraClient({
  apiKey: process.env.AGNITRA_API_KEY!,
  baseUrl: process.env.AGNITRA_API_BASE_URL ?? "https://api.agnitra.ai",
  timeoutMs: 30_000,
  retry: { attempts: 3, backoffMs: 500 },
});
```

## Run an optimization

```ts
import type { ModelGraph, TelemetrySeed } from "agnitra";

export async function optimizeModel(
  modelGraph: ModelGraph,
  telemetry: TelemetrySeed
) {
  const { outputs, bottleneck, usageEvent } = await agnitra.optimize({
    target: "A10G",
    modelGraph,
    telemetry,
    metadata: { release: "2024.09", channel: "edge-worker" },
  });

  return {
    artifactUrl: outputs.optimizedArtifactUrl,
    expectedSpeedup: bottleneck.expectedSpeedupPct,
    usageEvent,
  };
}
```

Artifacts can be downloaded via `outputs.optimizedArtifactUrl` or streamed directly into object storage using the `downloadOptimizedArtifact` helper.

## Edge and serverless deployments

- **Vercel / Netlify / Cloudflare Workers:** Store the API key as an encrypted environment variable. The SDK is ESM-compatible and tree-shakable.
- **AWS Lambda / Google Cloud Functions:** Bundle the SDK with your function; provide a cold-start cache for model graphs to reduce latency.
- **Node services:** Rotate API keys automatically with your secrets manager and log telemetry hashes for auditing.

## Usage event routing

```ts
import { exportUsageToStripe } from "agnitra/telemetry";

const result = await agnitra.optimize({ modelGraph, telemetry });

await exportUsageToStripe({
  usageEvent: result.usageEvent,
  stripeApiKey: process.env.STRIPE_API_KEY!,
});
```

Other options include `exportTelemetryToHttp`, `exportTelemetryToS3`, and direct access to `result.telemetry` for custom sinks.

## Error handling & resilience

- Wrap calls in retry logic for idempotent requests (job polling).
- Use circuit breakers around long-running optimizations in latency-sensitive paths.
- Monitor `usageEvent.status` and resend on 5XX responses from external billing systems.

## TypeScript support

The package ships with first-class typings. Enable `skipLibCheck: false` to get stricter verification and integrate the SDK into large mono-repositories with confidence.

## Testing

- Stub Agnitra responses with your preferred mocking framework (e.g., `msw`, `nock`).
- Record fixture telemetry from staging runs and replay them in unit tests.
- Add end-to-end smoke tests that call the SDK with lightweight models to ensure credentials and network config stay healthy.

Continue by aligning command-line automation via the [CLI guide](./cli) or plugging telemetry into downstream systems with the [Telemetry & Billing guide](./telemetry).
